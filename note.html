<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" charset="UTF-8" src="abcjs_basic_5.10.3-min.js" defer></script>
	<script type="text/javascript" charset="UTF-8" src="js_utils.js"></script>
	<script type="text/javascript" charset="UTF-8" src="abc_script.js" defer></script>
	<script type="text/javascript" charset="UTF-8" src="script.js" defer></script>
	<link type="text/css" rel="stylesheet" href="style.css"/>
</head>
<body>

<div class="setting">
	<label for="search-song">搜尋</label>
	<div id="search-song-container">
		<input type="search" id="search-song"/>
		<div id="song-list" tabindex="2"></div>
	</div>
	<button id="load-song">載入</button>
	<button id="save-song" disabled>存檔</button>
</div>
<div class="setting">
	<input type="checkbox" id="open-textarea">
	<label for="open-textarea">原始文字</label>
	<textarea id="abc-text"></textarea>
</div>
<div class="setting">
	<label>小節分割</label>
	<form id="measure-divide" data-beat-num="4">
		<input type="radio" id="md-1" name="measure-divide" value="1" checked/><label value="1" for="md-1">1</label>
		<input type="radio" id="md-2" name="measure-divide" value="2"/>        <label value="2" for="md-2">2</label>
		<input type="radio" id="md-3" name="measure-divide" value="3"/>        <label value="3" for="md-3">3</label>
		<input type="radio" id="md-4" name="measure-divide" value="4"/>        <label value="4" for="md-4">4</label>
		<input type="radio" id="md-6" name="measure-divide" value="6"/>        <label value="6" for="md-6">6</label>
		<input type="radio" id="md-8" name="measure-divide" value="8"/>        <label value="8" for="md-8">8</label>
	</form>
</div>

<div id="editor"></div>

<div class="chord-composer-container">
	<div id="chord-composer">
		<button onclick="chord_editor.delChord(chord_span_get_selection())">Delete</button>
		<div class="chord-keyboard root-major"
			onclick="chord_editor.setChord(event.target.innerText, 'set', chord_span_get_selection())"></div>
		<div class="chord-keyboard root-minor"
			onclick="chord_editor.setChord(event.target.innerText + 'm', 'set', chord_span_get_selection())"></div>
		<hr>
		<div id="chord-mod" onclick="chord_editor.setChord(event.target.innerText, 'append', chord_span_get_selection())"></div>
		<div class="chord-keyboard chord-bass"
			onclick="chord_editor.setChord('/' + event.target.innerText, 'append', chord_span_get_selection())">
		</div>
	</div>
	<script>
	var tone = ['C', 'C#', 'Db', 'D', 'D#', 'Eb', 'E', 'F', 'F#', 'Gb', 'G', 'G#', 'Ab', 'A', 'A#', 'Bb', 'B'];
	function addKeyButtons(elem) {
	  var buttons = tone.map(t=>{
		var b = document.createElement('button');
		b.innerHTML = t;
		b.className = t.length == 1 ? 'white key' : 'black key';
		return b;
	  });
	  elem.append(...buttons);
	}
	addKeyButtons(document.querySelector('.root-major'));
	addKeyButtons(document.querySelector('.root-minor'));
	addKeyButtons(document.querySelector('.chord-bass'));
	////////
	var chord_mod = ['m', 'maj', 'dim', '-', 'aug', '+', 'sus', 'sus4', '(b5)', '(b9)', '2', '6', '7', '9', '11', '13',]
	var buttons = chord_mod.map(s=>{
		var b = document.createElement('button');
		b.innerHTML = s;
		return b;
	});
	document.querySelector('#chord-mod').append(...buttons);
	</script>
</div>

<script type="text/javascript" charset="UTF-8" defer>
document.querySelector('#abc-text').value = `X: 906
T: 耶穌對我真好
M: 4/4
L: 1/8
Q: 1/4=148
K: G
%%staves (chord melody)
V: melody stem=solo
G2 GG- GF2E- |[K:G]ED2D- D4 |[M:4/4]G2 GG- GF2E- |[M:4/4][K:G]ED2D zB, DE- |
w: 耶 穌 曾 ~ 為 我 ~ 捨 命 ~ 祂 已 從 ~ 死 裡 ~ 復 活 祂 是 主
w: 祂 活 在 ~ 我 的 ~ 心 裡 ~ 運 行 在 ~ 我 生 ~ 命 中 ~ ~ ~
-E6 E2 |F6 A2 |A3D- D2 D2- |D6 z2 |
w: ~ 我 神 得 勝 的 ~ 主 ~
GG GG- GF2E- |ED2D- D4 |GG GG- GF2E- |ED2D zB, DE- |
w: 死 亡 權 勢 ~ 已 被 ~ 打 敗 ~ 爭 戰 得 勝 ~ 生 命 ~ 恢 復 祂 是 主
w: 耶 穌 充 滿 ~ 在 我 ~ 心 以 ~ 祂 無 比 的 ~ 大 愛 ~ ~ ~ ~ ~ ~
-E6 E2 |F6 A2 |A3G- G2 G2- |G6 z2 |
w: ~ 我 神 得 勝 的 ~ 主 ~
|:B3B- BA2A- |AG2G- G4 |A3A- AG2G- |GF2F- F4 |
w: 耶 穌 ~ 對 我 ~ 真 好 ~ 耶 穌 ~ 對 你 ~ 真 好 ~
E2 G6 |G2 FG- G2 A2 |1 A4 D3D- |D6 z2 :|2 A4 G3 G- |G8 |]
w: 耶 穌 祂 對 我 ~ 對 你 真 好 ~ 你 真 好 ~
V: chord
"G"x8|[K:G]x8|[M:4/4]x8|[M:4/4][K:G]x8|
"C"x8|"D"x8|"G"x8|x8|
"G"x8|x8|x8|x8|
"C"x8|"D"x8|"Em7"x8|x8|
|:"Cmaj7"x8|x8|"Bm7"x8|x8|
"Am7"x8|"D"x8|1"G6"x8|"G"x8:|2"Am/G"x7"G"x1|x8|]`
</script>
</body>
</html>